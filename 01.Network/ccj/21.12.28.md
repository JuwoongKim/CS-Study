# 21.12.28
##TCP와 UDP

---

#### 💡 TCP와 UDP의 특징과 차이점을 설명해주세요.
- TCP는 연결형 서비스로 신뢰성을 보장한다. 신뢰성 보장을 위해 오류제어, 흐름제어, 혼잡제어를 제공  
- UDP는 비연결형 서비스로 비신뢰적이지만 빠른 속도를 제공한다. 실시간 스트리밍에 사용됨
#### 💡 TCP를 사용하는 대표적인 프로토콜은 무엇인가요?
- HTTP가 있음
#### 💡 3-Handshaking과 4-Handshaking의 과정을 설명해주세요.
- 3-Handshaking 클라이언트가 서버에게 연결 요청. 서버는 클라이언트에게 확인 및 승낙 ACK + SYN 패킷 전송. 클라이언트는 확인 ACK 전달하고 연결
- 4-Handshaking 클라이언트가 서버에게 종료 요청. 서버는 확인 ACK 전달. 데이터 전송 완료 후 클라이언트에게 FIN 전달. 클라이언트는 서버에게 확인 ACK전송 후 연결 종료
`SYN` , `4-Handshaking`
#### 💡 3-way handshaking 과정에서 클라이언트가 서버가 보낸 ACK+SYN을 받지 못하면?
- 클라이언트는 서버에게 SYN 세그먼트를 보내고 시간을 잰다. TimeOut이 되기전까지 서버에게 ACK, SYN 세그먼트가 오지 않으면 클라이언트는 다시 SYN 세그먼트를 보내고 수신 대기
#### 💡 클라이언트와 서버는 무엇인가요?
- server, client란 데이터를 저장하고 관리하는 서버 부분과 해당 서버에 접속하여 데이터를 열람하는 클라이언트 부분으로 구성된 네트워크 구조
#### 💡 4-way handshaking 과정에서 클라이언트가 마지막에 ACK를 굳이 보내는 이유?
- 서버가 보낸 FIN세그먼트를 클라이언트가 받지 못하면 클라이언트는 FIN_WAIT2 상태로 종료되지 못한 채 계속 기다림. 
하지만 서버는 이미 포트를 닫고 응답하지 않은 상태이기 때문에 클라이언트는 불필요한 자원을 소모할 수 있음
- `그렇다면 서버 또한 ACK가 오지 않는다면 다시 FIN 세그먼트를 보내겠네?`
#### 💡 만약 Server에서 FIN 세그먼트를 전송하기 전에 전송한 패킷이 Routing 지연이나 패킷 유실로 인한 재전송 등으로 인해 FIN 패킷보다 늦게 도착하는 상황이 발생하면 어떻게 될까?
- 클라이언트에서 세션을 종료시킨 후 도착하는 패킷은 Drop되고 유실됨
- 이러한 현상을 대비하여 FIN을 수신하더라도 일정시간 세션을 남겨놓고 잉여 패킷을 기다리는 과정(TIME_WAIT)을 거침
#### 💡 TCP의 연결 설정 과정(3단계)과 연결 종료 과정(4단계)이 단계가 차이나는 이유?
- 연결과 종료에서 한 단계 차이나는 이유는 클라이언트는 데이터 전송을 마쳤다고 해도 서버에서 보낼 데이터가 남아있을 수 있기 때문에 일단 FIN에 대한 ACK만 보내고 데이터를 모두 전송한 후에 서버도 FIN 메시지를 보내기 때문
#### 💡 초기 Sequence Number인 ISN을 0부터 시작하지 않고 난수를 생성해서 설정하는 이유?
- 0부터 시작하는 ISN은 쉽게 예측되어 보안에 취약함
- 또한 다른 사용자와 같은 포트를 사용하고 있을 때 패킷을 착각할 수 있는 경우가 생김
- 따라서 난수로 ISN을 초기화함
- `INS?`
#### 💡 UDP에서 신뢰도를 보장하는 방법을 설명해주세요.
- RUDP를 사용한다.
- `RUDP?`

---
### 정리
#### TCP(Transmission Control Protocol)
- 인터넷 상에서 데이터를 메시지 형태로 보내기 위해 IP와 함께 사용하는 프로토콜
- 연결형 서비스로 가상 회선 방식 제공
- 핸드쉐이크로 연결 & 해제
- 흐름 제어 & 혼잡 제어

#### UDP(User Datagram Protocol)
- 데이터를 데이터그램 단위로 처리하는 프로토콜
- 비연결형 서비스로 데이터그램 방식을 제공

#### 3-Handshaking
- TCP 통신을 이용하여 데이터를 전송하기 위해 네트워크 연결을 설정하는 과정
    1. C => S : SYN  
    접속 요청 프로세스 A가 연결 요청 메시지 전송(SYN)
    2. S => C : SYN + ACK  
    접속 요청을 받는 프로세스 S가 요청을 수락했으며, A도 포트를 열어달라는 메시지 전송
    3. C => S : ACK  
    마지막으로 접속 요청 프로세스 C가 수학 확인을 보내 연결을 맺음
       
#### 4-Handshaking
- TCP 연결을 해제하는 과정
    1. C => S : FIN  
    - 프로세스 C가 연결을 종료하겠다는 FIN 플래그 전송
    - 프로세스 S가 FIN플래그로 응답하기 전까지 연결을 계속 유지
    2. S => C : ACK
    - 프로세스 S가 일단 확인 메시지를 보내고 자신의 통신이 끝날 때까지 기다린다(Time_Wait 상태)
    - 자신이 전송할 데이터가 남아있으면 이어서 계속 전송한다
    3. S => C : FIN
    - 프로세스 S가 통신이 끝났으면 연결 종료 요청에 합의한다는 의미로 C에게  FIN 플래그를 전송
    4. C => S : ACK
    - 프로세스 C가 확인했다는 메시지를 전송
    
`포트가 왜 나옴?`, `port 상태`

#### SYN(Synchronize Sequence Number)
- 세션 연결하는데 사용하는 랜덤 번호

#### ACK(Acknowledgement)
- 응답 확인

#### FIN(Finish)
- 연결 해제

#### Reliable UDP
- UDP 로 TCP 처럼 가능하도록 한 느낌
- 잘 안쓰는 것 같음